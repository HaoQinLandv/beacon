/*! orange-ui 2.0.0 zhangdd@hzwesoft.com */
function OwWidget(a){if(!TypeUtil.hasArguments(arguments))throw new Error("html object must not be null");if(TypeUtil.isJQueryObject(a)||(a=$(a)),0===a.length)throw new Error("html object matches none elements");var b=arguments[1],c=arguments[2];if(TypeUtil.isBoolean(b)&&(c=b,b={}),c=void 0===c?!1:c,b=b?b:{},this.htmlObj=a,c||a[0].init||(c=!0),!c){var d=OwWidget.prototype._restoreWidget.apply(this,arguments);return d?d:this._loadInitOptions()}this._saveInitOptions(b),this.htmlObj.addClass("ow-widget"),this.init()}function OwPopover(){TypeUtil.apply(this,OwWidget,arguments)}function OwPagination(){TypeUtil.apply(this,OwWidget,arguments)}function OwTreeView(){TypeUtil.apply(this,OwWidget,arguments)}function OwFormControl(){TypeUtil.apply(this,OwWidget,arguments)}function OwCheck(){TypeUtil.apply(this,OwFormControl,arguments)}function OwDateInput(){TypeUtil.apply(this,OwFormControl,arguments)}function OwRefInput(){TypeUtil.apply(this,OwFormControl,arguments)}function OwTreeInput(){TypeUtil.apply(this,OwRefInput,arguments)}String.prototype.trim=function(){return this.replace(/(^[\\s]*)|([\\s]*$)/g,"")},String.prototype.ltrim=function(){return this.replace(/(^[\\s]*)/g,"")},String.prototype.rtrim=function(){return this.replace(/([\\s]*$)/g,"")},String.prototype.startsWith=function(a){return!a||a.length>this.length?!1:new RegExp("^"+a).test(this)},String.prototype.endsWith=function(a){return!a||a.length>this.length?!1:new RegExp(a+"$").test(this)},String.prototype.leftPad=function(a,b){return this._fillIfNeed(a,b,!0)},String.prototype.rightPad=function(a,b){return this._fillIfNeed(a,b,!1)},String.prototype._fillIfNeed=function(a,b,c){var d="";if(a<=this.length)return this;for(var e=0,f=a-this.length;f>e;e+=1)d+=b;return c?d+this:this+d},String.espMatcher=/&ensp;|&emsp;|&nbsp;|&lt;|&gt;|&amp;|&quot;|&copy;|&reg;|&times;|&divide;/gi,String.prototype.replaceEscape=function(){return this.replace(String.espMatcher,"")},Array.prototype.contains=function(a){if(this.indexOf)return this.indexOf(a)>=0;for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return!0;return!1};var ObjectUtil={getProperty:function(a,b){var c=arguments[2];if(!a)return c;var d=a[b];return void 0===d&&(d=c),d},copyProperty:function(a,b){b&&ObjectUtil.each(b,function(b,c){a[b]=c})},deepClone:function(a){var b={};if(!a)return a;var c=arguments.callee;return ObjectUtil.each(a,function(d,e){a!==e&&(b[d]=TypeUtil.isObject(e)||TypeUtil.isArray(e)?c(e):e)}),b},isEmpty:function(a){for(var b in a)return!1;return!0},each:function(a,b){if(a)for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])}},TypeUtil={tryCall:function(funcName){try{if("function"==typeof eval(funcName+"()"))return funcName()}catch(e){return null}},isString:function(a){return"string"==typeof a},isNumber:function(a){return"[object Number]"===Object.prototype.toString.call(a)},isBoolean:function(a){return"boolean"==typeof a},toBoolean:function(a){return a?!0:!1},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return!!a&&!a.nodeName&&a.constructor!=String&&a.constructor!=RegExp&&a.constructor!=Array&&/function/i.test(a+"")},isObject:function(a){return"object"==typeof a},isJQueryObject:function(a){return a instanceof jQuery},isNone:function(a){return!a&&(void 0===a||null===a||isNaN(a))},hasArguments:function(a){return a.length},apply:function(a,b,c){a._clazz||(a._clazz=a.constructor),a._parents||(a._parents=[]),a._parents.push(b),b.apply(a,c)},extend:function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a},judgeResult:function(a){return 0===a.length?void 0:1===a.length?a[0]:a},process:function(a,b){var c=0,d=arguments[2];!function(){for(var e=+new Date;c<a.length;c++){if(!(+new Date-e<100))return void setTimeout(arguments.callee,0);b(a[c],c)}d&&d()}()}},HtmlUtil={genId:function(){return Math.floor(1e3*Math.random())+"-"+(new Date).getTime()},hasElement:function(a){return document.getElementById(a)?!0:!1},isIE6To8:function(){return!-[1]},addClass:function(a,b){a.hasClass(b)||a.addClass(b)}};HtmlUtil.createTagIfNeeded=function(a,b){var c=$(b);return c.length>0?c:HtmlUtil.createTag(a,arguments[2],arguments[3])},HtmlUtil.createTag=function(a){var b=$("<"+a+"/>"),c=arguments.length>1?arguments[1]:null,d=arguments.length>2?arguments[2]:null;return TypeUtil.isJQueryObject(c)&&(d=c,c=null),d||(d=$(document.body)),ObjectUtil.each(c,function(a,c){b.attr(a,c)}),d.append(b),b},"undefined"==typeof _CURRENT_FOLDER_&&(_CURRENT_FOLDER_={});var _SCRIPTS_=document.scripts;_CURRENT_FOLDER_.orange=_SCRIPTS_[_SCRIPTS_.length-1].src.substring(0,_SCRIPTS_[_SCRIPTS_.length-1].src.lastIndexOf("/")+1),OwWidget.prototype._restoreWidget=function(){return this._clazz?null:new this.htmlObj[0]._clazz(arguments[0],arguments[1],arguments[2])},OwWidget.prototype._loadInitOptions=function(){var a=this;this.htmlObj.each(function(){return this.initOptions?(a.initOptions=jQuery.extend(!0,{},this.initOptions),!1):void 0}),this.htmlObj.each(function(){for(var b in this._key)if(this._key.hasOwnProperty(b)){var c=this._key[b];this._key!==c&&(a[b]=c)}})},OwWidget.prototype._saveInitOptions=function(a){a=a||{};var b=this;this.initOptions=jQuery.extend(!0,{},a),this.htmlObj.each(function(){this.initOptions=b.initOptions,this.init=!0,this._key={},this._clazz=b._clazz,this._parents=b._parents})},OwWidget.prototype.key=function(a,b){return this[a]=b,this.htmlObj.each(function(){this._key[a]=b}),b},OwWidget.prototype.option=function(a){return this.initOptions[a]=OwWidget.prototype._option.apply(this,arguments)},OwWidget.prototype._option=function(a){var b=arguments[1],c=arguments[2];TypeUtil.isArray(b)&&(c=b,b=void 0),TypeUtil.isNone(c)||TypeUtil.isArray(c)||(c=[c]);var d=ObjectUtil.getProperty(this.initOptions,a);return TypeUtil.isNone(d)&&(d=this.htmlObj.attr(a)),TypeUtil.isNone(d)&&!TypeUtil.isNone(b)&&(d=b),TypeUtil.isNone(d)?d:(c&&(c.contains(d)||(d=b)),d)},OwWidget.prototype.stringOption=function(a){var b=OwWidget.prototype._option.apply(this,arguments);return TypeUtil.isNone(b)?b:this.initOptions[a]=TypeUtil.isString(b)?b:b.toString()},OwWidget.prototype.booleanOption=function(a){return this.initOptions[a]=OwWidget.prototype._booleanOption.apply(this,arguments)},OwWidget.prototype._booleanOption=function(){if(arguments.length>2||TypeUtil.isArray(arguments[1]))throw new Error("there are only two valid value in boolean options: true/false");if(2==arguments.length&&arguments[1]!==!0&&arguments[1]!==!1)throw new Error("invalid default value");var a=OwWidget.prototype._option.apply(this,arguments);return a?(a=TypeUtil.isString(a)?a.toLowerCase():a,TypeUtil.isNumber(a)?0!==a:TypeUtil.isBoolean(a)?a:["true","y"].contains(a)):!1},OwWidget.prototype.numberOption=function(a){var b=+OwWidget.prototype._option.apply(this,arguments);return isNaN(b)&&(this.initOptions[a]=void 0),this.initOptions[a]=b},OwWidget.prototype.functionOption=function(a){if(2==arguments.length&&!TypeUtil.isFunction(arguments[1]))throw new Error("invalid default value");var b=this._option(a,arguments[1]);return this.initOptions[a]=TypeUtil.isFunction(b)?b:void 0},OwWidget.prototype.on=function(a,b){return this.htmlObj.bind(a,b)},OwWidget.prototype.emit=function(a,b){this.htmlObj.trigger(a,b)},OwWidget.prototype.init=function(){throw new Error("all orange widget must override init")},OwWidget.prototype.setEnabled=function(a){a?this.htmlObj.removeAttr("disabled"):this.htmlObj.attr("disabled","disabled")},TypeUtil.extend(OwPopover,OwWidget),OwPopover.counter=0,OwPopover.prototype.init=function(){var a=this.numberOption("height"),b=this.numberOption("width"),c=this.booleanOption("backdrop",!0),d=this.booleanOption("keyboard",!0),e=this;if(a&&this.htmlObj.css("height",a+"px"),b&&this.htmlObj.css("width",b+"px"),this.htmlObj.addClass("ow-popover ow-popover-dropdown dropdown-menu"),this.htmlObj.css("z-index",1050+OwPopover.counter++ +""),c){var f=[];f.push(this.htmlObj),TypeUtil.isBoolean(c)||f.push(c);var g=function(a){var b=!0;$.each(f,function(c){(f[c].has(a.target).length||f[c].is(a.target))&&(b=!1)}),b&&e.hide()};$(document.body).on("click",g).on("contextmenu",g)}d&&$(document).keyup(function(a){switch(a.keyCode){case 27:e.hide(!1)}})},OwPopover.prototype.toggle=function(a){this.htmlObj.is(":hidden")?this.show(a):this.hide()},OwPopover.prototype.show=function(a){var b=arguments[1];this.isHidden()&&(b||this.emit("before.show"),this.htmlObj.css("left",a.left),this.htmlObj.css("top",a.top),this.htmlObj.show(),b||this.emit("after.show"))},OwPopover.prototype.hide=function(){var a=arguments[0];this.isHidden()||(a||this.emit("before.hide"),this.htmlObj.hide(),a||this.emit("after.hide"))},OwPopover.prototype.isHidden=function(){return this.htmlObj.is(":hidden")},OwPopover.prototype.html=function(){return TypeUtil.hasArguments(arguments)?this.htmlObj.html(arguments[0]):this.htmlObj.html()},TypeUtil.extend(OwPagination,OwWidget),OwPagination.prototype.init=function(){this.uri=this.key("uri",this.stringOption("uri")),this.onPage=this.key("onPage",this.functionOption("on-page")),this.simple=this.key("simple",this.booleanOption("simple",!1)),this._init(this.numberOption("pages",1),this.numberOption("current",1))},OwPagination.prototype._init=function(){this.pages=arguments[0]?this.key("pages",arguments[0]):this.key("pages",1),this.current=arguments[1]?this.key("current",arguments[1]):this.key("current",1);var a=new EJS({url:_CURRENT_FOLDER_.orange+"template/pagination.ejs"}).render({pages:this.pages,current:this.current,simple:this.simple});this.htmlObj.html(a);var b=this.onPage,c=this.uri,d=this;this.htmlObj.find("li[p]").unbind("click").click(function(){var a=parseInt($(this).attr("p"));return b&&b(a),c?void(window.location.href=c.replace("%page%",a+"")):void d._init(d.pages,a)})},OwPagination.prototype.reset=function(){this._init(arguments[0],arguments[1])},OwPagination.prototype.limit=function(a){if("undefined"==typeof a||!TypeUtil.isNumber(a))throw new Error("pages must be a number");this.key("pages",a),this._init(this.pages,this.current)},OwPagination.prototype.extend=function(){this.key("pages",this.pages+1)},TypeUtil.extend(OwTreeView,OwWidget),OwTreeView.prototype.init=function(){this.filter=this.key("filter",this.booleanOption("filter",!1)),this._initTree()},OwTreeView.prototype._initTree=function(){var a=this.stringOption("format","ajax-json"),b=this.stringOption("data"),c=this.checkbox=this.key("checkbox",this.booleanOption("checkbox",!1)),d=this.functionOption("after-loaded"),e=this.functionOption("after-select"),f=this.option("selectable"),g=this.functionOption("after-dblclick"),h=this.option("search",!1),i=this.htmlObj,j=this,k={core:{themes:{name:"proton",responsive:!0}}};switch(a){case"json":if(!b)throw new Error("data must not be null");k.core.data=JSON.parse(b);break;case"html":break;case"custom":k.core.data=b;break;case"ajax-json":default:k.core.data={url:b,dataType:"json"}}return this.model=this.key("model",[]),this.htmlObj.on("model.jstree",function(a,b){b.nodes&&(j.model=j.model.concat(b.nodes))}),k.plugins=[],c?(k.checkbox={tie_selection:!1},k.plugins.push("checkbox")):(f&&("leaf"===f?f=function(a,b){var c=b.jstree(!0);return!c.is_parent(a)}:TypeUtil.isFunction(f)||(f=null)),this.htmlObj.on("select_node.jstree",function(a,b){if(f&&!f(b.node,i)){var c=i.jstree(!0);return void c.deselect_node(b.node,!0)}e&&e(b.node,i)}),this.htmlObj.on("dblclick.jstree",function(a){var b=i.jstree(!0),c=b.get_node(a.target);b.is_selected(c)&&g&&g(c,i)})),h&&(k.plugins.push("search"),TypeUtil.isObject(h)&&(k.search={},h.callback&&(k.search.search_callback=h.callback),k.search.show_only_matches=h.show_only_matches?!0:!1)),this.htmlObj.on("ready.jstree",function(){d&&d(i)}),this.tree=this.htmlObj.jstree(k)},OwTreeView.prototype.getSelected=function(){var a=arguments[0]?!0:!1,b=this.htmlObj.jstree(!0);return this.checkbox?b.get_checked(a):b.get_selected(a)},OwTreeView.prototype.setSelected=function(a){var b=this.htmlObj.jstree(!0),c=1===arguments.length?!0:arguments[1]?!0:!1;return this.checkbox?c?b.check_node(a):b.uncheck_node(a):c?b.select_node(a):b.deselect_node(a)},OwTreeView.prototype.selectAll=function(){var a=this.htmlObj.jstree(!0),b=0===arguments.length?!0:arguments[1]?!0:!1;return this.checkbox?b?a.check_all():a.uncheck_all():b?a.select_all():a.deselect_all()},OwTreeView.prototype.underline=function(){return this.htmlObj.jstree(!0)},OwTreeView.prototype.dataModel=function(){return this.model};var OwFlash={info:function(a){this.show({name:"ow-info-flash",text:a,title:"提示",style:"alert-info",countdown:arguments[1]})},confirm:function(a,b){this.show({name:"ow-confirm-flash",text:a,title:"确认",style:"alert-warning",buttons:[{button:"<button type='button' class='btn btn-success ow-btn-sm' data-dismiss='modal'>确定</button>",callback:function(){b()}},{button:"<button type='button' class='btn btn-default ow-btn-sm' data-dismiss='modal'>关闭</button>",callback:function(){$("#ow-confirm-flash").modal("hide")}}],countdown:!1})},success:function(a){this.show({name:"ow-success-dialog",text:a,title:"成功",style:"alert-success",countdown:arguments[1]})},failure:function(a){this.show({name:"ow-danger-dialog",text:a,title:"错误",style:"alert-danger",countdown:TypeUtil.isNone(arguments[1])?!1:TypeUtil.toBoolean(arguments[1])})},show:function(){var a=arguments[0]||{},b=a.name||"ow_flash",c=a.buttons||[],d=TypeUtil.isNone(a.countdown)?!0:TypeUtil.toBoolean(a.countdown);if(OwDialog.wrap(b)){var e="<div class='alert "+a.style+"'><button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button><h4>"+a.title+"</h4><p id='"+b+"-text' class='ow-hint-content'></p><p id='"+b+"-buttons' class='ow-hint-buttons'></p></div>";$("#"+b+"-content").html(e)}if($("#"+b+"-text").html(a.text),$("#"+b+"-buttons").html(""),0===c.length){var f=function(){$("#"+b).modal("hide")},g=$("#"+b+"-close-btn");if(0===g.length&&(g=$('<button id="'+b+'-close-btn" class="btn btn-default">关闭</button>')),d){var h=a.timeout||3;g.owCountDownButton({timeout:h,callback:f})}c.push({button:g,callback:f})}ObjectUtil.each(c,function(a,c){var d=$(c.button);$("#"+b+"-buttons").append(d);var e=c.callback;e&&(TypeUtil.isJQueryObject(d)||(d=$(d)),d.each(function(){d.callback=e}),d.click(function(){d.callback()}))}),$("#"+b).modal("show")}},OwDialog={wrap:function(a){var b;if(HtmlUtil.hasElement(a)){if(b=$("#"+a),b.hasClass("modal"))return!1}else b=HtmlUtil.createTag("div",{id:a});return b.attrs({"class":"modal",tabindex:"-1",role:"dialog","aria-labelledby":a+"-label","aria-hidden":"true"}),HtmlUtil.isIE6To8()||b.addClass("fade"),b.html()&&""!==b.html().trim()||b.append('<div id="'+a+'-content" class="modal-dialog"></div>'),!0}};TypeUtil.extend(OwFormControl,OwWidget),OwFormControl.prototype.value=function(){throw new Error("all orange form control widget must override getValue")},TypeUtil.extend(OwCheck,OwFormControl),OwCheck.prototype.init=function(){this.htmlObj.iCheck({checkboxClass:"icheckbox_square-red",radioClass:"iradio_square-red",increaseArea:"20%"})},OwCheck.prototype.isChecked=function(){return this.htmlObj.parents("div:first").hasClass("checked")},OwCheck.prototype.setChecked=function(a){this.htmlObj.iCheck(a===!0?"check":"uncheck")},OwCheck.prototype.setEnabled=function(a){this.htmlObj.iCheck(a===!0?"enable":"disable")},OwCheck.prototype.toggle=function(){this.htmlObj.iCheck("toggle")},OwCheck.prototype.destroy=function(){this.htmlObj.iCheck("destroy")},OwCheck.prototype.update=function(){this.htmlObj.iCheck("update")},OwCheck.prototype.on=function(a,b){OwCheck.events.contains(a)?this.htmlObj.on(a,b):OwWidget.prototype.on.apply(this,arguments)},OwCheck.events=["ifClicked","ifChanged","ifChecked","ifUnchecked","ifDisabled","ifEnabled","ifCreated","ifDestroyed"],OwCheck.prototype.value=function(){return this.isChecked()},TypeUtil.extend(OwDateInput,OwFormControl),OwDateInput.VIEW={YEAR:4,MONTH:3,DAY:2,HOUR:1,MINUTE:0,SECOND:-1},OwDateInput.prototype.init=function(){var a={language:"zh-CN",weekStart:1,todayBtn:!0,autoclose:!0,todayHighlight:!0,forceParse:!1,pickerPosition:"bottom-left"};switch(this.stringOption("data-date-format","yyyy-mm-dd")){case"yyyy":a.startView=OwDateInput.VIEW.YEAR,a.minView=OwDateInput.VIEW.YEAR;break;case"yyyy-mm":a.startView=OwDateInput.VIEW.YEAR,a.minView=OwDateInput.VIEW.MONTH;break;case"yyyy-mm-dd":a.startView=OwDateInput.VIEW.DAY,a.minView=OwDateInput.VIEW.DAY;break;case"yyyy-mm-dd hh":a.startView=OwDateInput.VIEW.DAY,a.minView=OwDateInput.VIEW.HOUR;break;case"yyyy-mm-dd hh:ii":a.startView=OwDateInput.VIEW.DAY,a.minView=OwDateInput.VIEW.MINUTE}this.htmlObj.datetimepicker(a);var b=this.htmlObj;this.htmlObj.datetimepicker().on("show",function(){b.attr("disabled")&&b.datetimepicker("hide")})},OwDateInput.prototype.value=function(){return this.htmlObj.is("input")?this.htmlObj.val():this.htmlObj.find("input").val()},TypeUtil.extend(OwRefInput,OwFormControl),OwRefInput.prototype.init=function(){var a=this.stringOption("focus-ref",".focus-ref"),b=this.stringOption("click-ref",".click-ref");if(this.focusRef=this.key("focusRef",this.htmlObj.find(a)),this.clickRef=this.key("clickRef",this.htmlObj.find(b)),0===this.focusRef.length)throw new Error("ref dialog trigger must be specified");this.popover=this._buildPopover(),this._bindRefActions();var c=this.initRef(this.initPopover()),d=this;this.popover&&this.popover.on&&(TypeUtil.isFunction(this.popoverOptions["before-show"])&&this.popover.on("before.show",function(){d.popoverOptions["before-show"](c)}),this.popover.on("before.hide",function(){d.onDismiss(c)}),this.popover.on("after.show",function(){d.htmlObj.attr("disabled")&&d.popover.hide()}))},OwRefInput.prototype._buildPopover=function(){var a=this.popoverOptions=this.option("popover")||{};a.width=TypeUtil.isNumber(a.width)?a.width:200,a.height=TypeUtil.isNumber(a.height)?a.height:300,a.backdrop=TypeUtil.isBoolean(a.backdrop)?a.backdrop:!0,a.keyboard=TypeUtil.isBoolean(a.keyboard)?a.keyboard:!0;var b=$("<div></div>");return $(document.body).append(b),new OwPopover(b,a)},OwRefInput.prototype._bindRefActions=function(){var a=this,b=this.focusRef;0!==b.length&&(b.focus(function(){a.popover.isHidden()?(b.focusing=!0,b.click()):b.refocus=!0}),b.click(function(c){!b.is(":focus")||b.focusing||b.refocus||a.popover.toggle(a._calculatePoint()),b.focusing=!1,b.refocus=!1,c.preventDefault(),c.stopPropagation()}));var c=this.clickRef;0!==c.length&&c.click(function(b){a.popover.toggle(a._calculatePoint()),b.preventDefault(),b.stopPropagation()})},OwRefInput.prototype._calculatePoint=function(){var a,b=this.focusRef,c=this.clickRef,d=this.htmlObj.offset().top+8;return a=0===c.length?b.offset().left+b.width()-this.popover.htmlObj.width()+8:c.offset().left+c.width()-this.popover.htmlObj.width()+8,{top:d,left:a}},OwRefInput.prototype.initPopover=function(){var a=this._showOptions();a.id=HtmlUtil.genId();var b=new EJS({url:_CURRENT_FOLDER_.orange+"template/default_ref_popover.ejs"}).render(a);return this.popover.html(b),this._bindBtnActions(a.id),a.id},OwRefInput.prototype._showOptions=function(){return{width:this.popoverOptions.width-10,height:this.popoverOptions.height-10,quick_select:!1}},OwRefInput.prototype._bindBtnActions=function(a){var b=this;this.confirmBtn=this.key("confirmBtn",$("#"+a+"-ok")),this.cancelBtn=this.key("cancelBtn",$("#"+a+"-cancel")),this.confirmBtn.click(function(){b.popover.hide()}),this.cancelBtn.click(function(){b.popover.hide(!0)})},OwRefInput.prototype.triggerConfirm=function(){this.confirmBtn.click()},OwRefInput.prototype.triggerCancel=function(){this.cancelBtn.click()},OwRefInput.prototype.initRef=function(){},OwRefInput.prototype.onDismiss=function(){},TypeUtil.extend(OwTreeInput,OwRefInput),OwTreeInput.prototype.initRef=function(a){var b=this._findTreeParent(a),c=this.option("treeview",{}),d=this,e=function(){var a=d.focusRef.val();a&&(a=a.split(/\s*,\s*/),TypeUtil.process(d.treeView.dataModel(),function(b){$.inArray(b,a)>=0&&d.treeView.setSelected(b,!0)},function(){d.onDismiss(d.treeView)}))},f=function(){d.triggerConfirm()};return this.treeOptions=this.key("treeOptions",c),c["after-loaded"]=c["after-loaded"]?function(a){e(a),c["after-loaded"](a)}:e,c.checkbox||(c["after-dblclick"]=c["after-dblclick"]?function(a,b){f(a,b),c["after-dblclick"](a,b)}:f),this.treeView=this.key("treeView",new OwTreeView(b,c)),this._initSearch(),this.treeView},OwTreeInput.prototype._findTreeParent=function(a){if(!a)throw new Error("you must specify the tree parent");var b;if(TypeUtil.isJQueryObject(a)){if(0===a.length)throw new Error("tree parent must exist");b=a}else{if(!TypeUtil.isString(a))throw new Error("you must specify the tree parent");if(b=$("#"+a),0===b.length&&(b=$(a)),0===b.length)throw new Error("tree parent must exist")}var c=b.attr("id");return c||(c=HtmlUtil.genId(),b.attr("id",c)),b},OwTreeInput.prototype._initSearch=function(){if(this.treeOptions.search){this.search=this.key("search",$(new EJS({url:_CURRENT_FOLDER_.orange+"template/search_field.ejs"}).render())),this.popover.htmlObj.prepend(this.search);var a,b=this,c=function(c){return c?void(a!==c&&(a=c,b.treeView.underline().search(c))):void d()},d=function(){a=null,b.treeView.underline().clear_search()};this.search.children("input").blur(function(){c($.trim($(this).val()))}).keyup(function(a){13===a.keyCode&&c($.trim($(this).val()))}),this.search.children("span.tree-search-cancel").click(function(){b.search.children("input").val(""),d()})}},OwTreeInput.prototype.onDismiss=function(){var a,b=this.booleanOption("leaf-only",!0),c=arguments.length>0?arguments[0]:void 0,d=this,e=[];if(c||(c=this.treeView),a=c.getSelected(!0),d.focusRef.val("处理中..."),!this.treeOptions.checkbox)return void d._setValue(a);if(b)TypeUtil.process(a,function(a){c.underline().is_parent(a)||e.push(a)},function(){d._setValue(e)});else{var f=$.map(a,function(a){return a.id});TypeUtil.process(a,function(a){var b=c.underline().get_parent(a);-1===$.inArray(b,f)&&e.push(a)},function(){d._setValue(e)})}},OwTreeInput.prototype._setValue=function(a){var b="";switch(a.length){case 0:break;case 1:b=a[0].text;break;case 2:b=a[0].text+","+a[1].text;break;default:b=a[0].text+"等"+a.length+"个"}this.focusRef.val(b),this.focusRef.attr("id-value",$.map(a,function(a){return a.id}).join(","))},OwTreeInput.prototype.value=function(){var a=arguments[0],b=this.treeView,c=this,d=b.dataModel();if(0===arguments.length)return this.focusRef.attr("id-value");if(!a)return void TypeUtil.process(d,function(a){b.setSelected(a,!1)},function(){c.onDismiss()});if(TypeUtil.isString(a))a=a.split(/\s*,\s*/);else if(!TypeUtil.isArray(a))throw new Error("parameter error for OwTreeInput.value, must be Array or String");this.focusRef.val("处理中..."),b.selectAll(!1),TypeUtil.process(d,function(c){-1!==$.inArray(c,a)&&b.setSelected(c)},function(){c.onDismiss()})},jQuery.fn.owRadio=function(){var a=[],b=arguments[0];return this.each(function(){a.push(new OwCheck($(this),b))}),TypeUtil.judgeResult(a)},jQuery.fn.owCheckbox=function(){var a=[],b=arguments[0];return this.each(function(){a.push(new OwCheck($(this),b))}),TypeUtil.judgeResult(a)},jQuery.fn.owDateInput=function(){var a=[],b=arguments[0];return this.each(function(){a.push(new OwDateInput($(this),b))}),TypeUtil.judgeResult(a)},jQuery.fn.owPopover=function(){var a=[],b=arguments[0];return this.each(function(){a.push(new OwPopover($(this),b))}),TypeUtil.judgeResult(a)},jQuery.fn.owRefInput=function(){var a=[],b=arguments[0];return this.each(function(){a.push(new OwRefInput($(this),b))}),TypeUtil.judgeResult(a)},jQuery.fn.owTreeView=function(){var a=[],b=arguments[0];return this.each(function(){a.push(new OwTreeView($(this),b))}),TypeUtil.judgeResult(a)},jQuery.fn.owTreeRefInput=function(){var a=[],b=arguments[0];return this.each(function(){a.push(new OwTreeInput($(this),b))}),TypeUtil.judgeResult(a)},jQuery.fn.attrs=function(a){var b=this;ObjectUtil.each(a,function(a,c){b.attr(a,c)})},jQuery.fn.owPagination=function(){var a=[],b=arguments[0];return this.each(function(){a.push(new OwPagination($(this),b))}),TypeUtil.judgeResult(a)},jQuery.fn.owPlaceholder=function(){"placeholder"in document.createElement("input")||this.each(function(){var a=$(this).attr("placeholder")||arguments[0];if(a){var b=$(this);$(this).focus(function(){$(this).val()&&$(this).val()!==a||($(this).removeClass("ow-placeholder"),$(this).val(""))}).blur(function(){$(this).val()&&$(this).val()!==a||($(this).addClass("ow-placeholder"),$(this).val(a))}).parents("form").eq(0).submit(function(){b.val()===a&&(b.removeClass("ow-placeholder"),b.val(""))}),$(this).trigger("blur")}})},jQuery.fn.owCountDownButton=function(){var a=arguments[0]||{},b=a.timeout||3,c=a.callback,d=function(a,b){var d=a.html();a.html(d+"("+b+")");var e=window.setInterval(function(){0>=b-1&&(a.html(d),c&&c(a),window.clearInterval(e)),a.html(d+"("+(b-1)+")"),b-=1},1e3)};this.each(function(){d($(this),b)})};